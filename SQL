-- câu 1a diện tích >= 5000 km2
SELECT TEN_T_TP,DS
FROM TINH_TP
WHERE DT >= 5000

-- câu 1b có diện tích >= [input]
SELECT TEN_T_TP,DS
FROM TINH_TP
WHERE DT >= 7000

-- câu 2 xuất tên tỉnh,tp và dt của TINH_TP
SELECT TEN_T_TP, DT
FROM TINH_TP

-- câu 3 Thuộc miền 'Bắc'
SELECT TEN_T_TP
FROM TINH_TP
WHERE MIEN = N'Bắc'

-- câu 4 thuộc miền [input]
SELECT TEN_T_TP
FROM TINH_TP
WHERE MIEN = N'Trung'

-- câu 5 xuấ tra tên tỉnh,tp biên giới thuộc miền [input]
SELECT TEN_T_TP
FROM TINH_TP,BIENGIOI
WHERE tinh_tp.MA_T_TP = BIENGIOI.MA_T_TP AND MIEN = N'Nam'

-- câu 6
SELECT TEN_T_TP,SUM(DT) / COUNT(MA_T_TP) AS DTTB
FROM TINH_TP
GROUP BY TEN_T_TP


-- câu 7
SELECT TEN_T_TP,DS
FROM TINH_TP
WHERE DT > 7000

-- câu 8 cho biết ds cùng tên tỉnh ở miền 'Bắc'
SELECT DS,TEN_T_TP
FROM TINH_TP
WHERE MIEN = N'Bắc'

-- câu 9
SELECT TEN_T_TP,NUOC,MIEN
FROM TINH_TP,BIENGIOI
WHERE TINH_TP.MA_T_TP = BIENGIOI.MA_T_TP AND MIEN = N'Nam'

-- câu 10 
SELECT TEN_T_TP,AVG(DT) AS DTTB
FROM TINH_TP
GROUP BY TEN_T_TP

-- câu 11
SELECT TINH_TP.DS / TINH_TP.DT AS MDDS, TEN_T_TP
FROM TINH_TP

-- câu 12
SELECT TEN_T_TP
FROM LANGGIENG,TINH_TP
WHERE TINH_TP.MA_T_TP = LANGGIENG.LG AND LANGGIENG.MA_T_TP = 'LA'

-- câu 13
SELECT COUNT(*) as [số lượng giáp với CPC]
FROM BIENGIOI
WHERE NUOC = 'CPC'


-- câu 14
SELECT TEN_T_TP AS [Diện tích lớn nhất]
FROM TINH_TP
WHERE DT = (SELECT MAX(DT) FROM TINH_TP)

-- câu 15 cho biết tỉnh,TP có MDDS đông nhất
SELECT TOP 1 TEN_T_TP, (DS/DT) AS MDDS
FROM TINH_TP
ORDER BY MDDS DESC

-- câu 16 cho biết tên những tỉnh,tp giáp với hai nước biên giới khác nhau
SELECT TEN_T_TP
FROM TINH_TP,BIENGIOI
WHERE TINH_TP.MA_T_TP = BIENGIOI.MA_T_TP GROUP BY TEN_T_TP HAVING COUNT(*) = 2

-- câu 17 cho biết danh sách các miền cùng với các tỉnh,tp trong các miền đó
SELECT TEN_T_TP,MIEN
FROM TINH_TP
ORDER BY MIEN

-- câu 18 cho biết tên những tỉnh,TP có nhiều láng giềng nhất
SELECT TINH_TP.MA_T_TP, TEN_T_TP, COUNT(TINH_TP.MA_T_TP) as [Số lượng Tỉnh_TP]
FROM LANGGIENG,TINH_TP
WHERE TINH_TP.MA_T_TP = LANGGIENG.MA_T_TP
GROUP BY TEN_T_TP, TINH_TP.MA_T_TP
HAVING COUNT(TEN_T_TP) >= ALL (SELECT COUNT(TEN_T_TP) FROM TINH_TP T, LANGGIENG L WHERE T.MA_T_TP = L.MA_T_TP GROUP BY T.MA_T_TP)

-- câu 19
SELECT TEN_T_TP, MA_T_TP, DT
FROM TINH_TP
WHERE DT < (SELECT AVG(DT) FROM TINH_TP)

-- câu 20
SELECT TEN_T_TP
FROM TINH_TP
WHERE MIEN != 'Nam' AND MA_T_TP IN
(SELECT LANGGIENG.LG
FROM TINH_TP,LANGGIENG
WHERE TINH_TP.MA_T_TP=LANGGIENG.MA_T_TP and MIEN ='Nam')
